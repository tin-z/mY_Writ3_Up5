// ConsoleApplication1.cpp : definisce il punto di ingresso dell'applicazione console.
//

#include "stdafx.h"
#include <iostream>
//#include <OleCtl.h>
#include <Ole2.h>


extern "C" __declspec(dllexport) int wmain(int argc, wchar_t *argv[], wchar_t *envp[]);
//extern "C" __declspec(dllexport) HGLOBAL OleGetIconOfFile(LPOLESTR lpszPath, IN BOOL fUseFileAsLabel);
extern "C" __declspec(dllexport) WINOLEAPI_(HGLOBAL) OleGetIconOfFile(_In_ LPOLESTR lpszPath, IN BOOL fUseFileAsLabel);

/*
extern "C" __declspec(dllexport)	WINOLECTLAPI OleLoadPicturePath(
	LPOLESTR szURLorPath,
	LPUNKNOWN punkCaller,
	DWORD dwReserved,
	OLE_COLOR clrReserved,
	REFIID riid,
	LPVOID *ppvRet
);
*/

int wmain(int argc, wchar_t *argv[], wchar_t *envp[])

{
	if (argc < 2) { printf("[x] Usage: filename"); exit(-1); }
	/*
	IPicture *p;
	OleLoadPicturePath((LPOLESTR)argv[1], 0, 0, 0, IID_IPicture, (LPVOID*)&p);
	*/
	OleGetIconOfFile((LPOLESTR)argv[1], (BOOL)NULL);
}


